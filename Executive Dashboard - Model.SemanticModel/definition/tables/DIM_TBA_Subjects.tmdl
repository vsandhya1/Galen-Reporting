table DIM_TBA_Subjects
	lineageTag: 89890618-95a6-4019-a0ea-9559c9a618b6

	column SEC_SUBJECT
		dataType: string
		lineageTag: 4be717fb-356b-4803-9e5e-4cf7ee53a5ba
		summarizeBy: none
		sourceColumn: SEC_SUBJECT

		annotation SummarizationSetBy = Automatic

	partition DIM_TBA_Subjects = m
		mode: import
		queryGroup: Academics
		source =
				let
				    Source = Sql.Database("rpt2-prod.ec.galencollege.edu", "coll18_repl_production", [Query="With CurrentTerm AS (#(lf)#(tab)SELECT TOP 1 TERM_START_DATE, TERMS_ID, 'Current' TermType#(lf)#(tab)#(tab)FROM TERMS CT#(lf)#(tab)#(tab)WHERE RIGHT(CT.TERMS_ID, 1) = 'Q'#(lf)#(tab)#(tab)AND GETDATE() >= TERM_START_DATE#(lf)#(tab)#(tab)ORDER BY TERM_START_DATE DESC),#(lf)FutureTerm AS( SELECT TOP 1 TERM_END_DATE, TERMS_ID, 'Future' TermType#(lf)#(tab)#(tab)FROM TERMS CT#(lf)#(tab)#(tab)WHERE RIGHT(CT.TERMS_ID, 1) = 'Q'#(lf)#(tab)#(tab)AND GETDATE() < CT.TERM_END_DATE#(lf)#(tab)#(tab)AND GETDATE() < TERM_START_DATE#(lf)#(tab)#(tab)ORDER BY TERM_END_DATE ASC),#(lf)AcceptableTerms AS (#(lf)#(tab)SELECT * FROM CurrentTerm UNION SELECT * FROM FutureTerm)#(lf)#(lf)SELECT DISTINCT SEC_SUBJECT#(lf)FROM COURSE_SECTIONS CS#(lf)#(tab)INNER JOIN COURSE_SEC_FACULTY CSF ON CS.COURSE_SECTIONS_ID = CSF.CSF_COURSE_SECTION#(lf)#(tab)INNER JOIN INSTR_METHODS IM ON CSF.CSF_INSTR_METHOD = IM.INSTR_METHODS_ID#(lf)#(tab)INNER JOIN AcceptableTerms T ON CS.SEC_TERM = T.TERMS_ID#(lf)#(tab)INNER JOIN SEC_STATUSES S ON S.COURSE_SECTIONS_ID = CS.COURSE_SECTIONS_ID AND S.POS = 1#(lf)#(tab)--WHERE CSF.CSF_FACULTY = 1122928"])
				in
				    Source

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

